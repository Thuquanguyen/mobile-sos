import 'dart:convert';import 'package:flutter/cupertino.dart';import 'package:hello_wolrd/database/database_helpers.dart';import 'package:http/http.dart' as http;import 'package:google_maps_flutter/google_maps_flutter.dart';import 'station_item.dart';class Station with ChangeNotifier {  Map<String, Marker> _itemsMarker = {};  List<StationItem> _itemStation = [];  List<StationItem> _itemSearch = [];  StationItem _stationItem;  bool _isSearch = false;  bool _isContact = false;  String _textSearch = "";  int _isfavorite;  CameraPosition _cameraPosition = CameraPosition(    target: LatLng(21.025142, 105.833101),    zoom: 14.4746,  );  LatLng _latLng = LatLng(21.025142, 105.833101);  List<StationItem> get itemStation {    return [..._itemStation];  }  List<StationItem> get itemSearchStation {    return [..._itemSearch];  }  Map<String, Marker> get itemsMarker {    return {..._itemsMarker};  }  StationItem get station {    return _stationItem;  }  CameraPosition get cameraPosition {    return _cameraPosition;  }  LatLng get latlng {    return _latLng;  }  String get textSearch {    return _textSearch;  }  int get isFavorite {    return _isfavorite;  }  // ignore: missing_return  LatLng findByStationId(int id) {    StationItem stationItem = findById(id);    _textSearch = stationItem.name;    _isSearch = false;    _latLng = LatLng(stationItem.lat, stationItem.long);    notifyListeners();  }  bool get isSearch {    return _isSearch;  }  bool get isContact {    return _isContact;  }  void setContact() {    _isContact = false;    notifyListeners();  }  StationItem findById(int id) {    return _itemStation.firstWhere((station) => station.id == id);  }  // ignore: missing_return  List<StationItem> findNameStation(String name) {    _itemSearch = name != ""        ? _itemStation            .where((station) =>                station.name.toLowerCase().contains(name.toLowerCase()))            .toList()        : [];    _isSearch = _itemSearch.length != 0 ? true : false;    notifyListeners();  }  Future<void> setFavorite(int id) async {    _isfavorite = _isfavorite == 0 ? 1 : 0;    notifyListeners();  }  Future<void> getFavorite(int id) async {    _isfavorite = _isfavorite == 0 ? 1 : 0;    DatabaseHelper helper = DatabaseHelper.instance;    StationItem stationItem = await helper.queryStation(id);    if (stationItem == null) {      _isfavorite = 0;    } else {      _isfavorite = 1;    }    notifyListeners();  }  Future<void> removeItemStation(int id) async {    DatabaseHelper helper = DatabaseHelper.instance;    List<StationItem> stationItem = await helper.deleteStation(id);    if (stationItem == null) {      return;    }    _isfavorite = _isfavorite == 0 ? 1 : 0;    notifyListeners();  }  Future<void> fetDataMaker() async {    const url = 'https://sos-manage.firebaseio.com/station.json';    final response = await http.get(url);    List<StationItem> loadStation = [];    final extractData = json.decode(response.body) as Map<String, dynamic>;    if (extractData == null) {      return;    }    extractData.forEach((stationId, stationData) {      getFavorite(stationData["id"]);      StationItem item = StationItem();      item = StationItem(          id: stationData["id"],          name: stationData["name"],          address: stationData["address"],          email: stationData["email"],          website: stationData["website"],          about: stationData["about"],          openAndCloseTime: stationData["open_close_time"],          lat: stationData["lat"],          long: stationData["long"],          rate: stationData["rate"],          confirmAddress: stationData["confirm"],          favorite: _isfavorite,          imageList: stationData["image"],          phoneNumber: stationData["phone_number"],          supportDetails: stationData["support_details"],          workingDay: stationData["working_day"]);      Marker marker = Marker(          markerId: MarkerId("$stationId"),          position: LatLng(stationData["lat"], stationData["long"]),          infoWindow: InfoWindow(title: stationData["name"]),          onTap: () {            _stationItem = item;            _isContact = true;            notifyListeners();          });      _stationItem = item;      loadStation.add(item);      _itemsMarker["m$stationId"] = marker;    });    _itemStation = loadStation.reversed.toList();    notifyListeners();  }  void clear() {    _itemsMarker = {};    _itemStation = [];    notifyListeners();  }}